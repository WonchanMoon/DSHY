---
날짜: 2025-01-19
완료: false
tags:
  - 딥러닝
  - CNN
---

## 10.3 Visualizing Trained CNNs
- 앞에서 인공지능의 레이어들이 단순한 특징에서 복잡한 모양 순으로 인식을 한다는 것을 배움

#### 가보르 필터(Gabor filters)
- 뇌에서 작용하는 시각 세포들을 설명하기 위한 2차원 함수
- 특정 방향으로 뻗은 선이나 패턴을 찾음
- 특정 위치에서만 반응하도록 국소화
>"특정 각도"와 "특정 간격(주파수)"으로 반복되는 무늬(예: 줄무늬나 선)를 찾아주는 도구

$$G(x, y) = A \exp(-\alpha \tilde{x}^2 - \beta \tilde{y}^2) \sin(\omega \tilde{x} + \phi)
$$
여기서
$$\tilde{x} = (x - x_0) \cos(\theta) + (y - y_0) \sin(\theta)
$$
$$\tilde{y} = -(x - x_0) \sin(\theta) + (y - y_0) \cos(\theta)
$$
- $\theta$의 역활?
	- 필터의 방향
	- $\theta$ = 0: 수평 방향의 선(가로줄)에 민감.
	- $\theta$ = 90: 수직 방향의 선(세로줄)에 민감.
	- $\theta$ = 45 대각선 방향의 선에 민감.
- $\alpha, \beta$의 역활은?
	- 필터의 크기와 범위의 조정
- $\sin(\omega \tilde{x} + \phi)$의 역활
	- 진동수, 패턴이 시작되는 위치를 조정


### 살리언시 맵(Saliency Maps)
- 결국 입력한 이미지가 어뜬 특정 클래스 레이블인지를 결정해야함
- 여기서 어떤 영역이 레이블을 가르는데 가장 중요한지 찾는 것이 **살리언시 맵**
- 당연히 최종 합성곱 계층에서 이를 분석하는 것이 가장 좋음
	- 최종 합성곱 계층은 여전히 공간적 정보를 보유하고 있지만, 이후 완전 연결 계층으로 넘어가명 공간적 정보가 손실됨
#### Grad-CAM(Gradient Class Activation Mapping) 기법
- 입력 이미지의 주어진 클래스 $C$에 대해 최종 합성곱 계층 $A^{K}$ 의 출력값과 그에 대한 그레이디언트(gradient, $\frac{\partial a^c}{\partial A_{tj}^{(k)}}$)를 계산
- 이 그레이디언트는 해당 클래스의 점수에 대한 필터 $k$의 중요도를 나타냄
- 기여도 계산
	- $M_k$ : 채널 k의 전체 유닛수
$$\alpha_k = \frac{1}{M_k} \sum_i \sum_j \frac{\partial a^c}{\partial A_{ij}^{(k)}}$$
- 최종 살리언시 맵 $L$ 생성
$$L = \sum_k \alpha_k A^{(k)}$$
- 결과로 나온 $L$배열은 최종 합성곱 계층의 크기와 동일한 차원을 가짐
- 히트맵으로 시각화 가능
![[Pasted image 20250119073952.png]]

### 적대적 공격 (Adversarial Attacks)
- 신경망이 이미지를 잘못 분류하도록 공격하는 것
#### Fast Gradient Sign Method (FGSM)
- 필셀값 변경
	- 이미지의 각 픽셀 값 x에 작은 상수 $\epsilon$만큼 변화량을 추가
$$x' = x + \epsilon \cdot \operatorname{sign}(\nabla_x E(x, t))$$
- 아주 작은 값을 추가하는 것 만으로도 분류결과를 완전 바꿔 버릴 수 있다
- 추후에 생길 보완 문제와 연결됨

### 합성 이미지 (Synthetic Images)
#### Deep Dream
- 특정한 특징이 과장된 이미지를 생성하는 방법
- 신경망에서 특정 노드가 강하게 반응하도록 입력 이미지를 조작
- 과정
    - 특정 노드 선택:
        - 신경망에서 해당 영역에 "고양이" 패턴을 감지하는 노드를 선택
    - 이미지 수정:
        - 입력 이미지를 수정하여 이 노드의 반응을 더 강하게 만듦.
    - 역전파(backpropagation) 사용:
        - 선택된 노드의 사전 활성화 값(pre-activation values)를 기준으로 손실 함수를 정의하고, 역전파를 통해 입력 이미지에서 해당 값을 점진적으로 증가.
    - 이미지 업데이트:
        - 한 번의 업데이트마다 이미지를 조금씩 수정하여 점진적으로 원하는 특징을 강조

---

## 객체 탐지 (Object Detection)
- 이미지 내에 하나 이상의 클래스가 존재 할 수 있고, 우리는 각 개체의 존재와 클래스를 감지해야함
- 우리는 **바운딩 박스**를 활용하여 일반적으로 객체 탐지를 표시함
### Intersection-over-Union
- 객체를 정확히 찾아내는 프로그램이 얼마나 잘 작동하는지 평가하려면 **객체의 위치**를 파악해야함
- 이를 위해 **Intersection-over-Union**을 활용
- 교집합 영억
	- 맞춘부분
- 합집합 영역
	- 모든 부분
- 두 영역의 크기를 비교하여 비율로 나타낸것이 IoU
- 0~1의 값으로 나오고, 1이면 완전 정답, 0이면 완전오답
![[Pasted image 20250119084052.png]]

### Sliding Windows
- 개요
	- 훈련된 모델(CNN)을 바탕으로 이미지 전체를 훑으며 특정 위치를 스캔하여 각 위치를 분류기로 평가 -> Sliding Windows
	- 특정위치에 높은 확률로 객체가 있다면 바운딩 박스로 표시를 할 수 있음
- 단점
	- 다만 이렇게 전체적으로 모든 크기의 객체를 훑으면 계산량이 압도적으로 많아진다
		- 원도우를 이미지 위로 이동할때 한번에 한 픽셀이 아니라 더 큰 단계로 이동하여 줄일 수 있다
- 효율적인 해결 방법
	- CNN 구조적 특성을 활용
	- CNN에서 클라스의 특징을 추출하고 이를 기반으로 특징 맵을 생성한다
	- 한번의 연산으로 여러영역을 동시에 처리가능

![[Pasted image 20250119084759.png]]

### Detection across scales
- 개요
	- 내가 원하는 클래스가 전혀 다른 형태를 취하고 있을 수 있다
- 예시
	- 가까이 있는 객체와 멀리있는 객체의 윈도우 크기는 달라 질 수 밖에 없음
- 해결 방안
	- 이미지를 여러 크기로 복사
	- 각 크기에서 윈도우를 사용해 객체를 감지
	- 찾은 결과를 원래 이미지의 위치로 반환
	- 다양한 크기의 모양을 다룰 수 있어 정확도가 높아짐
### Non-max suppression
- 개요
	- 확률 기반으로 바운딩 박스를 찾으면, 여러 바운딩 박스로 동시에 탐지 될 수 있다.
	- 이러면 결과가 복잡해짐
- 해결 방법
	- 겹치는 박스가 있을 경우 해당 박스들중 확률이 가장 높은 박스만 반환 해주도록 해야함

### Fast region CNNs
- 개요
	- 탐지의 시간을 단축해야할 필요성이 있음
- 해결방안
	- **중요한 부분(Region Proposal)** 을 빠르게 찾는 방법을 사용
	- 어떤 원리인지는 설명이 없음
	- 따로 찾아본 봐로는 밝기, 색상 경계선 등의 정보를 활용해 위치를 제한하는 형식(정확하지는 않음)