---
date: 2025-06-21
완료: false
tags:
---
> 연관관계(association)는 인과관계(causation)가 아니다.

하지만 연관관계는 때로 인과관계가 될 수도 있다!

## 🔍 Causal Inference란 무엇인가?

### 연관성과 인과성의 차이
- **연관(Association)**: 두 변수 간에 함께 움직이는 관계를 의미합니다. 이는 두 변수 사이에 어떤 형태로든 관계가 존재함을 나타내지만, 한 변수가 다른 변수를 직접적으로 변화시키는 것은 아닙니다.
- **인과(Causation)**: 한 변수의 변화가 다른 변수의 변화를 _직접적으로_ 유발하는 관계를 의미합니다. 이는 원인과 결과의 명확한 관계를 나타냅니다.

### 일상 속 인과 추론의 예시
- 우리는 일상생활에서 경험적으로 **인과 추론**을 자주 합니다.
	- "소주 3병을 마시면 다음날 힘들다"라는 판단은 과거 경험에 기반한 인과적 판단입니다.
- 그러나 통계학적으로는 "연관 = 인과"가 아니라는 점을 강조해야 합니다. 연관성이 있다고 해서 반드시 인과성이 있는 것은 아닙니다.

### 잘못된 인과 추론의 위험성
- 잘못된 인과 추론의 사례는 다음과 같습니다:
	- 만휘씨는 두번 정도 먹은 새우가 아주 맛이 없었습니다.
	- 그래서 자신은 새우 알러지가 있고 스스로 판단 했습니다.
	- 그렇게 20년이 지나고 다시 새우를 먹었는데, 오잉 왜 맛있지?

###  Causal Inference의 정의
- 인과 추론(Causal Inference)은 연관성으로부터 인과성을 추론하려는 과학적 시도를 의미합니다. 이는 언제 연관이 인과로 이어지는지, 그리고 왜 그렇지 않은지를 분석하는 학문입니다. 인과 추론은 복잡한 데이터 속에서 진정한 인과 관계를 밝혀내는 데 중점을 둡니다.


## 🔍 왜 인과 추론을 하는가?

### 이해를 넘어 실천을 위한 인과 추론
- 인과 추론은 단순히 세상을 이해하는 것을 넘어, **개입(intervention)** 을 통해 더 나은 결과를 얻기 위해 중요합니다.
- 예시:
	- "술을 많이 마시면 두통이 온다"는 인과를 알기에, 다음에는 적게 마시기로 **행동을 바꿉니다**.
	- 기업은 "마케팅 비용이 매출 증가를 유도하는가?"를 알아내어, **투자 전략을 최적화**합니다.
- 결국 인과 추론은 "**원인을 조작해서 결과를 바꾸고자 하는 실용적 목적**"에 초점을 맞춥니다.

### 산업 현장에서의 인과 추론: '결정과학'의 일부
- 이 책은 특히 **현업에서 유용한 인과 추론**, 즉 "개입의 효과"에 초점을 둡니다.
- 실용적 질문 예시:
	- 가격을 바꾸면 매출에 어떤 영향을 줄까요?
	- 식단을 바꾸면 건강에 어떤 변화가 있을까요?
	- 대출 한도를 늘리면 수익이 어떻게 변할까요?
	- 도서관 vs 태블릿 제공 중 어떤 게 학업 성취에 더 효과적일까요?
- 이처럼 인과 추론은 **변화를 통해 더 나은 결과를 만들기 위한 질문**을 해결합니다.

---

## 🤖 머신러닝 vs 인과 추론

### ML은 예측에 강하지만, 인과 추론엔 약하다
- 머신러닝은 주로 "**예측(predictive)**"에 특화되어 있습니다.
- 하지만 인과 추론은 "**만약 ~한다면 어떤 일이 일어날까?(What if)**"라는 **개입 중심의 질문**을 다룹니다.

### 왜 ML은 인과 추론에 취약한가?
- ML은 학습한 조건을 **바꾸지 않는 한** 뛰어난 성능을 보입니다.
- 그러나 **개입을 고려하는 순간**, 기존의 관계가 깨지기 시작합니다.
	- 예: 비수기에는 호텔 가격이 낮고 매출도 낮다 → ML은 "가격을 높이면 매출이 오른다"고 잘못 판단할 수 있습니다.

| 항목 | 내용 |
| --- | --- |
| 인과 추론의 목적 | 단순 이해를 넘어 개입을 통한 결과 개선 |
| 산업에서의 역할 | 개입의 효과를 예측하여 의사결정에 활용 |
| ML의 한계 | 상관관계는 잘 예측하지만 인과관계를 잘못 해석할 수 있음 |
| 잘못된 ML 사용 예 | 가격과 매출 사이의 상관관계로 인해 잘못된 결론을 내리는 경우 |
| 해결 방향 | ML을 재설계하여 인과 추론에 맞게 사용하는 방법이 존재함 |

- 나중에 일반적인 머신러닝 알고리즘이 인과 추론 활용을 위해 어떻게 재탄생 되는지 나온다고 합니다.
	- 기대기대





## 용어 정리
- 분석단위(unit of analysis)
	- 일반적으로 개입하려는 대상
- 처치(treatment)
	- 구하려는 효과에 대한 개입을 나타 낼 때 사용하는 용어
	- $T$ 혹은 $D$ 를 활용
$$T_i = 
\begin{cases}
1 & \text{if unit } i \text{ received the treatment} \\
0 & \text{otherwise}
\end{cases}$$
- 결과(outcome)
	- 실험대상 i의 결과
	- $Y_i$
- 개입(intervention)
	- 인과 모델을 사용하여 특정 질문에 답하기 위해 모델 내의 변수를 조작하는 것을 의미
	- $do(.)$ 로 작성

## 사례: 온라인 마켓플레이스와 가격 할인 정책

### 문제 상황
- 당신은 온라인 마켓 플랫폼 회사에 근무하고 있으며, 중소기업들이 자율적으로 가격 설정과 세일 시점을 결정함.
- 플랫폼의 성공은 입점한 기업의 성공에 달려 있음 → **이들을 도와주고 싶음.**

### 분석 목표
- **가격 인하(할인)가 판매량 증가에 미치는 인과적 영향**을 파악하고 싶음.
- 단순히 세일을 한 업체가 매출이 높았다고 해서, "세일 덕분이다"라고 결론 내릴 수 없음.

### 인과적 질문
> "할인을 하지 않았을 때에 비해, 할인을 했을 경우 얼마나 더 많이 팔렸을까?"
- 이는 단순한 상관관계 분석이 아니라, **개입(intervention)** 에 따른 결과 변화, 즉 **인과 추론** 문제

![[Pasted image 20250621213640.png]]

### 인과추론의 근본적인 문제

>동일한 실험 대상이 '처치'를 받지 않은 상태를 동시에 관측 할 수 없다는점

![[Pasted image 20250621214642.png]]
- 그래프를 보면 상품 가격을 낮춘 상점들의 판매량이 훨씬 더 많았음을 알 수 있습니다.
- 과연 그럼 세일과 판매량은 인과관계인가?
	- 조금만 더 깊이 생각을 해보면, 판매량이 많게 나타난 이유는 상품을 가장 많이 판매하는 대기업들이 더 공격적으로 가격을 낮출 여유가 있기 때문 일 수 도 있습니다.
	- 아니면 고객들이 가장 많이 구매하는 크리스마스에 할인이 진행 되었기 때문을 수 도 있다.
- 이러한 문제는 동일한 회사에서 할인이 진행 되는 상황과 그렇지 않은 상황을 동시에 관측 할 수 있어야만 가격할인이 판매량을 미치는 실제 효과를 확신 할 수 있다는 점입니다.
	- 하지만 이것은 불가능 합니다.
	- 그래서 다른 방법을 찾아야 한다.

### 인과모델
$$ \begin{align*}
T &\leftarrow f_t(u_t) \\
Y &\leftarrow f_y(T, u_y)
\end{align*}$$
- 인과모델(causal model)은 화살표로 표시하는 일련의 할당 메커니즘입니다.
- $u$ : 외부 변수 집합(내생변수), 아직 설명되지 않은 변수의 모든 변동을 설명하기 위한 것 
$$\begin{align*}
IsOnSales &\leftarrow f_t(u_t) \\
AmountSold &\leftarrow f_y(IsOnSales, u_y)
\end{align*}$$

- 위에서 말했던 '대기업이기 때문에 할인을 할 수 있었다'를 표현하면
$$\begin{align*}
BusinessSize &\leftarrow f_s(u_s) \\
IsOnSales &\leftarrow f_t(BusinessSize, u_t) \\
AmountSold &\leftarrow f_y(IsOnSales, BusinessSize, u_y)
\end{align*}$$

## 개입
### do(.) 연산자란?
- `do(.)`는 **인과 효과(causal effect)** 를 명시하기 위해 사용하는 **이론적 연산자**입니다.
- 관찰 데이터를 기반으로 한 조건부 기대값과는 **다른 의미**를 가집니다.

---

### 연관(Association) vs. 인과(Causation)
- 예시: 할인 여부가 매출에 미치는 영향을 살펴보는 경우

| 구분     | 의미                            | 예시 표현                                                | 설명                                                       |
| ------ | ----------------------------- | ---------------------------------------------------- | -------------------------------------------------------- |
| **연관** | 실제로 할인한 기업들의 평균 매출            | $E[\text{AmountSold} \mid \text{IsOnSales} = 1]$     | 이미 자발적으로 할인을 선택한 기업(보통 규모가 크거나 매출이 높을 수 있음)을 대상으로 계산된 평균 |
| **인과** | 모든 기업에 할인 조치를 강제로 했을 때의 평균 매출 | $E[\text{AmountSold} \mid do(\text{IsOnSales} = 1)]$ | 전체 기업이 할인을 하도록 **개입**했을 때 기대되는 평균 매출                     |

- 이 둘은 **같지 않다**:  
$$
E[\text{AmountSold} \mid \text{IsOnSales} = 1] \ne E[\text{AmountSold} \mid do(\text{IsOnSales} = 1)]
$$

---

### 선택 vs. 개입의 차이
- **조건부 기대값 (연관)**:  
  → 이미 할인을 선택한 **부분 집단**만을 본다. (선택된 표본에 의한 편향 가능)
  
- **do(.) 기대값 (인과)**:  
  → **모든 집단에 개입**하여 할인을 강제로 적용한 뒤 전체 집단을 본다. (정책 개입 시 기대 결과에 가까움)

---

### do(.)의 실제적 의미
- 현실에서는 `do(IsOnSales = 1)` 상태를 **관찰할 수 없다**. (실제 개입을 하지 않았기 때문)
- 따라서 do(.)는 **이론적 도구**로서, 우리가 구하고자 하는 **인과적 양을 명시**하는 데 사용됨.
- 관찰된 데이터로부터 do(.)를 제거하여 인과 효과를 추정하는 과정은 **식별(identification)** 이라 부른다.

---

요약하자면, **do(.)는 인과 효과를 명시하기 위한 도구이며**, 일반적인 조건부 기대값과는 달리 **개입(intervention)** 을 전제로 하므로, 단순한 관찰만으로는 구할 수 없습니다. 인과 추론은 바로 이 차이를 이해하고, 이를 극복하기 위한 방법론을 연구하는 분야입니다.

![[Pasted image 20250621221658.png]]

#인과추론 #연관관계 #인과관계 #개입 #머신러닝 #예측 #데이터분석 #정책개입